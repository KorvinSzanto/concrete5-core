!function(a,b){"use strict";function c(a,c){var d=this,c=b.extend({chooseText:ccmi18n_sitemap.choosePage,loadingText:ccmi18n_sitemap.loadingText,inputName:"cID",cID:0},c);d.$element=a,d.options=c,d._chooseTemplate=_.template(d.chooseTemplate,{options:d.options}),d._loadingTemplate=_.template(d.loadingTemplate,{options:d.options}),d._pageLoadedTemplate=_.template(d.pageLoadedTemplate),d._pageMenuTemplate=_.template(ConcretePageAjaxSearchMenu.get()),d.$element.append(d._chooseTemplate),d.$element.on("click","a[data-page-selector-link=choose]",function(a){a.preventDefault(),ConcretePageAjaxSearch.launchDialog(function(a){d.loadPage(a.cID)})}),d.options.cID&&d.loadPage(d.options.cID)}c.prototype={chooseTemplate:'<div class="ccm-item-selector"><input type="hidden" name="<%=options.inputName%>" value="0" /><a href="#" data-page-selector-link="choose"><%=options.chooseText%></a></div>',loadingTemplate:'<div class="ccm-item-selector"><div class="ccm-item-selector-choose"><i class="fa fa-spin fa-spinner"></i> <%=options.loadingText%></div></div>',pageLoadedTemplate:'<div class="ccm-item-selector"><div class="ccm-item-selector-item-selected"><input type="hidden" name="<%=inputName%>" value="<%=page.cID%>" /><a data-page-selector-action="clear" href="#" class="ccm-item-selector-clear"><i class="fa fa-close"></i></a><div class="ccm-item-selector-item-selected-title"><%=page.name%></div></div></div>',loadPage:function(a){var b=this;b.$element.html(b._loadingTemplate),ConcretePageAjaxSearch.getPageDetails(a,function(a){var c=a.pages[0];b.$element.html(b._pageLoadedTemplate({inputName:b.options.inputName,page:c})),b.$element.on("click","a[data-page-selector-action=clear]",function(a){a.preventDefault(),b.$element.html(b._chooseTemplate)})})}},b.fn.concretePageSelector=function(a){return b.each(b(this),function(d,e){new c(b(this),a)})},a.ConcretePageSelector=c}(this,$);